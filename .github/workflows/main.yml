name: CICD-Workshop
on:
  push:
    branches:
      # 1.The pipeline should be triggered whenever this is a push to a branch name with the following pattern release/v<digit>.<digit>
      - 'main'

jobs:
  security-scan:
    runs-on: ubuntu-latest
    steps:
    - name: Checkout code
      uses: actions/checkout@v3
    - name: Set timezone
      run: |
        cp /usr/share/zoneinfo/Asia/Shanghai /etc/localtime
    - name: Set color
      id: color-selector
      run: echo "SELECTED_COLOR=green" >> "$GITHUB_OUTPUT"
    - name: Get color
      env:
        SELECTED_COLOR: ${{ steps.color-selector.outputs.SELECTED_COLOR }}
      run: |
        echo "The selected color is $SELECTED_COLOR"
        echo "::set-output name=SELECTED_COLOR::green"

  send-message:
    needs: [security-scan]
    if: ${{ needs.security-scan.outputs.SELECTED_COLOR == 'green' }}
    runs-on: ubuntu-latest
    steps:
    - name: test
      run: |
        echo yes
